-- Example: Tag and Masking Policies
CREATE TAG IF NOT EXISTS SENSITIVITY CLASS='PUBLIC';
CREATE MASKING POLICY IF NOT EXISTS MP_EMAIL AS (val STRING) RETURNS STRING -> CASE WHEN CURRENT_ROLE() IN ('PII_READER') THEN val ELSE '***MASKED***' END;
ALTER TABLE IF EXISTS PUBLIC.CUSTOMERS MODIFY COLUMN EMAIL SET MASKING POLICY MP_EMAIL;
