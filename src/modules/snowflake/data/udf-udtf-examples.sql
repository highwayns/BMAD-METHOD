-- UDF/UDTF examples (illustrative)
CREATE OR REPLACE FUNCTION F_SCORE(amount NUMBER) RETURNS FLOAT AS $$ amount / 100.0 $$;
CREATE OR REPLACE TABLE FUNCTION TF_TOPN(k NUMBER) RETURNS TABLE(user_id STRING, score FLOAT) AS $$ SELECT user_id, score FROM SCORES ORDER BY score DESC LIMIT k $$;
